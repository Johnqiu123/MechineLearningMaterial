# 聚类算法

[TOC]

## 参考文献

https://blog.csdn.net/qrlhl/article/details/78512598



## 算法是什么

聚类算法的核心是计算文本之间的相似度得分，本算法从词频、词性以及语义多个维度来构建显示度得分，其中词频、词性是通过tf-idf模型进行构建，而语义是通过word2vec模型进行构建，具体如下：

$score=w_1*score1 + w_2 * score2 + w_3 * score3$

其中score1表示基于word2vec模型生成的源文本与目标文本特征相似度计算得分，使用的是wmd距离，score2表示由TF-IDF在以分词后的语料库作为训练数据得到的模型—TF-IDF模型1，生成的矩阵表示，与基于该模型生成的用户输入问题文本特征相似度计算得分，score3表示由TF-IDF在以分词后并进行词性标注的语料库作为训练数据得到的模型—TF-IDF模型2，生成的矩阵表示，与基于该模型生成的用户输入问题文本特征相似度计算得分。

【wmd距离】

使用wmd距离（词移距离）的优势：直接用余弦相似度来计算文本特征向量的相似性存在的问题是无法从文档整体上来考虑相似性，仅仅是基于词，这就造成了很大的信息缺失问题，而使用词移距离则可以从文本的整体上考虑两者的相似性

公式：$\sum_{i,j=1}^n T_{ij}c(i,j)$

其中，$c(i,j)$为i，j两个词所对应的词向量的欧式距离，T表示加权矩阵，整体表示是文档1转换成文档2所需要付出的总代价。

例子：

A：Obama speaks to the media in illinois

B：The president greets the press in Chicago

有两个文档，去除停用词后，每篇文档仅剩下4个词，我们就是要用这四个词来比较两个文档之间的相似度。在这里，我们假设’Obama’这个词在文档1中的的权重为0.5（可以简单地用词频或者TFIDF进行计算），那么由于’Obama’和’president’的相似度很高，那么我们可以给由’Obama’移动到’president’很高的权重，这里假设为0.4，文档2中其他的词由于和’Obama’的距离比较远，所以会分到更小的权重。这里的约束是，**由文档1中的某个词ii移动到文档2中的各个词的权重之和应该与文档1中的这个词ii的权重相等，即’Obama’要把自己的权重（0.5）分给文档2中的各个词。**同样，文档2中的某个词jj所接受到由文档1中的各个词所流入的权重之和应该等于词jj在文档2中的权重。




CountVectorizer和Tf-idfVectorizer构建词向量都是通过构建字典的方式，比如在情感分析问题中，我需要把每一个句子（评论）转化为词向量，这两种方法是如何构建的呢？拿CountVectorizer来说，首先构建出一个字典，字典包含了所有样本出现的词汇，每一个词汇对应着它出现的顺序和频率。对于每一个句子来说，构建出来的词向量的长度就是整个词典的长度，词向量的每一维上都代表这一维对应的单词的频率。同理，Tf-idf就是将频率换成Tf权值。

基本步骤：

1）数据准备
数据准备部分需要准备两部分数据，第一部分是与京东商城相关的电商行业的文本数据，作为基础语料库，第二部分是具体业务相关的数据，也就是我们要处理的问题数据库，其中，基础语料库的数据的量级越大，词库中的词量越全模型效果越好。
2）数据预处理
这一部分，主要是对收集到的数据，进行分词，词性标注，以及去掉一些停用词和标点符号，只保留有效的数据。得到两套有效的数据语料分别是分词后的语料库，分词后进行词性标注的语料库。
2）模型训练
数据处理好后，借助两套工具，分别是TF-IDF工具，和Word2vec工具，进行模型训练，其中Word2vec在分词后的语料库进行训练，得到Word2vec模型，TF-IDF工具在两套语料上训练，得到TF-IDF模型1，和TF-IDF模型2。
3）特征表示（一个问题生成三个特征矩阵）
训练好特征工程的模型后，我们将模型问题库中所有的问题表示成向量，每个问题通过一个模型表示成一个向量，其中向量的维度由各个模型自身决定，每个模型对所有的问题则表示成一个特征向量矩阵， 三个模型得到三个特征表示矩阵。
4）计算得分
将用户输入的文本特征与已经计算好的向量矩阵进行求相似度的计算，Tf-idf模型以余弦距离作为向量度量的标准，wordvec模型以wmd距离作为向量度量标准，得到3个不同的相似度得分，根据实际情况，分别赋予各个特征不同的的权重，则得到所有问题库中问题的最终相似度得分

5）聚类

基于文本两两之间的最终相似度得分，设定一个阈值，只有大于该阈值，我们才认为两者相似，然后将相似的文本聚合成簇





## 算法是用来解决什么问题，效果如何

聚类算法是用来解决文本的相似度计算问题



## 算法如何进行训练





## 算法的优缺点是什么

## 算法的改进方案

## 面试问题